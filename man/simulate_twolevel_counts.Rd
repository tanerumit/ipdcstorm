% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hazard_climate.R
\name{simulate_twolevel_counts}
\alias{simulate_twolevel_counts}
\title{Simulate two-level annual counts with climate modifications}
\usage{
simulate_twolevel_counts(
  lambda_table,
  k_hat,
  n_years_sim,
  sst_anomaly = NULL,
  beta_sst = 0,
  gamma_intensity = 0,
  p_hur_base = NULL,
  .sst_abs_max = 10,
  .sst_scale_max = 1000,
  .mu_total_max = 1e+06
)
}
\arguments{
\item{lambda_table}{Tibble from \code{compute_lambda_table()}.}

\item{k_hat}{Numeric; Gamma shape parameter for overdispersion.}

\item{n_years_sim}{Integer; number of years to simulate.}

\item{sst_anomaly}{Optional numeric vector of I"SST values (A?C) per year.}

\item{beta_sst}{Numeric; SST rate scaling coefficient (Level 1).}

\item{gamma_intensity}{Numeric; intensity shift coefficient (Level 2).
Represents fractional change in p_HUR per A?C of SST warming.}

\item{p_hur_base}{Optional numeric; baseline hurricane fraction. If NULL,
computed from lambda_table.}

\item{.sst_abs_max}{Numeric guardrail for absolute SST anomaly magnitude.}

\item{.sst_scale_max}{Numeric guardrail for \code{exp(beta_sst * sst_anomaly)}.}

\item{.mu_total_max}{Numeric guardrail for annual Poisson mean.}
}
\value{
Tibble with columns: sim_year, activity_factor, sst_anomaly,
climate_scale, activity_combined, p_hurricane, n_total, n_ts, n_hur.
}
\description{
Non-stationary extension of the Poisson-Gamma annual count model with
two levels of climate modification:

\strong{Level 1 (Rate scaling):} Each year's activity factor is modulated by SST:
A_t = activity_factor A- exp(I2_SST A. I"SST_t)

\strong{Level 2 (Intensity shift):} The storm-class split varies with SST:
p_HUR(t) = clamp(p_HUR_base A- (1 + I3 A. I"SST_t), 0.01, 0.99)
N_total_t ~ Poisson(I>_total A- A_t)
n_HUR_t ~ Binomial(N_total_t, p_HUR(t))
n_ts_t = N_total_t a^' n_hur_t

When gamma_intensity is 0, class split is constant (Level 1 only).
When both beta_sst and gamma_intensity are 0, reduces to stationary model.
}
